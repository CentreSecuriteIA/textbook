<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://ai-safety-atlas.com/chapters/09/03/ rel=canonical><link href=../02/ rel=prev><link href=../04/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>9.3 Interventional Methods - AI Safety Atlas</title><link rel=stylesheet href=../../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../overrides/css/base.css><link rel=stylesheet href=../../../overrides/css/buttons.css><link rel=stylesheet href=../../../overrides/css/tippy.css><link rel=stylesheet href=../../../overrides/css/tabs.css><link rel=stylesheet href=../../../overrides/css/typography.css><link rel=stylesheet href=../../../overrides/css/admonitions.css><link rel=stylesheet href=../../../overrides/css/navigation.css><link rel=stylesheet href=../../../overrides/css/metadata.css><link rel=stylesheet href=../../../overrides/css/figures.css><link rel=stylesheet href=../../../overrides/css/footer.css><link rel=stylesheet href=../../../overrides/css/section-end.css><link rel=stylesheet href=../../../overrides/css/scroll-buttons.css><link rel=stylesheet href=../../../overrides/css/home/base.css><link rel=stylesheet href=../../../overrides/css/home/hero.css><link rel=stylesheet href=../../../overrides/css/home/hero-animation.css><link rel=stylesheet href=../../../overrides/css/home/header.css><link rel=stylesheet href=../../../overrides/css/home/why.css><link rel=stylesheet href=../../../overrides/css/header.css><link rel=stylesheet href=../../../overrides/css/audio-player.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@700;800;900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700;800;900&display=swap"><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#03 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="AI Safety Atlas" class="md-header__button md-logo" aria-label="AI Safety Atlas" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AI Safety Atlas </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 9.3 Interventional Methods </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> Book </a> </li> <li class=md-tabs__item> <a href=../../../feedback/ class=md-tabs__link> Feedback </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="AI Safety Atlas" class="md-nav__button md-logo" aria-label="AI Safety Atlas" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> AI Safety Atlas </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Book </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Book </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Chapters </span> </a> <label class="md-nav__link " for=__nav_2_1 id=__nav_2_1_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=true> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Chapters </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../01/ class=md-nav__link> <span class=md-ellipsis> 01 - Capabilities </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../02/ class=md-nav__link> <span class=md-ellipsis> 02 - Risks </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../03/ class=md-nav__link> <span class=md-ellipsis> 03 - Strategies </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../04/ class=md-nav__link> <span class=md-ellipsis> 04 - Governance </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../05/ class=md-nav__link> <span class=md-ellipsis> 05 - Evaluations </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../06/ class=md-nav__link> <span class=md-ellipsis> 06 - Specification </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../07/ class=md-nav__link> <span class=md-ellipsis> 07 - Generalization </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../08/ class=md-nav__link> <span class=md-ellipsis> 08 - Scalable Oversight </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_10 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> 09 - Interpretability </span> </a> <label class="md-nav__link " for=__nav_2_1_10 id=__nav_2_1_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_1_10_label aria-expanded=true> <label class=md-nav__title for=__nav_2_1_10> <span class="md-nav__icon md-icon"></span> 09 - Interpretability </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01/ class=md-nav__link> <span class=md-ellipsis> 9.1 What is Interpretability ? </span> </a> </li> <li class=md-nav__item> <a href=../02/ class=md-nav__link> <span class=md-ellipsis> 9.2 Observational Methods </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 9.3 Interventional Methods </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 9.3 Interventional Methods </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#01 class=md-nav__link> <span class=md-ellipsis> 9.3.1 Activation Patching </span> </a> <nav class=md-nav aria-label="9.3.1 Activation Patching"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#01 class=md-nav__link> <span class=md-ellipsis> 9.3.1.1 Limitations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#02 class=md-nav__link> <span class=md-ellipsis> 9.3.2 Activation Steering </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../04/ class=md-nav__link> <span class=md-ellipsis> 9.4 Automating and Scaling Interpretability </span> </a> </li> <li class=md-nav__item> <a href=../05/ class=md-nav__link> <span class=md-ellipsis> 9.5 Critiques of Interpretability </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../feedback/ class=md-nav__link> <span class=md-ellipsis> Feedback </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#01 class=md-nav__link> <span class=md-ellipsis> 9.3.1 Activation Patching </span> </a> <nav class=md-nav aria-label="9.3.1 Activation Patching"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#01 class=md-nav__link> <span class=md-ellipsis> 9.3.1.1 Limitations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#02 class=md-nav__link> <span class=md-ellipsis> 9.3.2 Activation Steering </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=03>9.3 Interventional Methods<a class=headerlink href=#03 title="Permanent link">&para;</a></h1> <div class=section-meta> <div class=meta-item> <i class="fas fa-clock"></i> 8 min read </div> <div class=meta-item> <i class="fas fa-file-alt"></i> 1573 words </div> </div> <h2 id=01>9.3.1 Activation Patching<a class=headerlink href=#01 title="Permanent link">&para;</a></h2> <p><strong>Activation patching is a technique used to understand and pinpoint specific parts of a model responsible for certain behaviors or outputs</strong>. For example, when you ask an LLM to complete the sentence: “When John and Mary went to the store, John gave a bottle to”, how does the model know it should answer “Mary” instead of “John” or some other name? This completion requires the model to track which person is the recipient of the action, meaning it has to understand and store contextual roles (i.e., who is giving and who is receiving).</p> <p>Researchers have used <abbr title="A technique that identifies which parts of a neural network are responsible for specific behaviors by selectively replacing activations.">activation patching</abbr> to discover which parts of the model are responsible for this kind of role assignment. Specifically, the goal is to identify the circuit (i.e., the group of neurons and connections) that helps the model decide that “Mary” is the correct answer (<a href="https://openreview.net/forum?id=NpsVSN6o4ul">Wang et al., 2023</a>).</p> <div class="admonition warning"> <p class=admonition-title>Below is extra detail provided for those interested. It can be safely skipped.</p> </div> <p>To illustrate the <abbr title="A technique that identifies which parts of a neural network are responsible for specific behaviors by selectively replacing activations.">activation patching</abbr> process, consider the figure below (<a href=https://arxiv.org/abs/2404.15255>Heimersheim &amp; Nanda, 2024</a>). Let’s say we want to understand how a model completes the sentence "<em>When John and Mary went to the store, John gave a bottle to</em>" and which components are involved in choosing "Mary" as the answer. Activation patching generally requires<strong> </strong><strong>three stages</strong>:</p> <ol> <li> <p><strong>Clean Input</strong>: On the left, the model processes the sentence “<em>John and Mary went to the store, John gave a bottle to</em>” generating a series of <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> (outputs from each layer) shown in green. This clean input provides the model with the correct context to interpret “John” as the giver and “Mary” as the recipient. The model predicts “Mary”.</p> </li> <li> <p><strong>Corrupted Input</strong>: On the right, the model is given a corrupted input: “<em>Bob and Mary went to the store, John gave a bottle to</em>” In this case, the <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> (in red) will differ because the model is now processing “Bob” instead of “John”. Here, there is an ambiguity about whether “Mary” or “John” is the intended recipient, so the answer will not necessarily be “Mary”.</p> </li> <li> <p><strong>Patching Process</strong>: <strong>Activation patching involves taking specific <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> from the clean input “John and Mary…” and substituting them into the corrupted input “Bob and Mary…”</strong>. This is indicated by the arrow. By patching <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> from the clean input, we can test whether the model's understanding of "John" as the giver and "Mary" as the recipient can be restored, even when the corrupted input with "Bob" creates ambiguity. At this step, we observe how much the model prediction shifts towards “Mary”. For example, if patching the <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> of a specific attention head increases the logit for “Mary”, it suggests that head is an important part of the circuit responsible for the task. </p> </li> <li> <p><strong>Iterating</strong> this procedure over different layers and components (such as attention heads or MLPs) allows researchers to identify the components most responsible for the target behavior.</p> </li> </ol> <figure> <a class=glightbox href=../Images/tXz_Image_22.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt="Enter image alt description" loading=lazy src=../Images/tXz_Image_22.png></a> <br> <figcaption><b>Figure 9.22:</b> An illustration of the <abbr title="A technique that identifies which parts of a neural network are responsible for specific behaviors by selectively replacing activations.">activation patching</abbr> process. On the left, the model processes a clean input sequence "John and Mary," with <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> shown in green. On the right, the model processes a corrupted input sequence "Bob and Mary," with <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> shown in red. Activation patching involves replacing one or more <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> in the corrupted sequence with corresponding <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> from the clean sequence (indicated by the arrow). The resulting patched <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> are then passed forward to observe how they affect the model’s output logits. By analyzing whether the patched <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> restore the desired output, researchers can identify which parts of the model’s <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> are responsible for specific behaviors or outputs. From (<a href=https://arxiv.org/abs/2309.16042>Zhang &amp; Nanda, 2023</a>).</figcaption> </figure> <figure> <a class=glightbox href=../Images/n96_Image_23.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt="Enter image alt description" loading=lazy src=../Images/n96_Image_23.png></a> <br> <figcaption><b>Figure 9.23:</b> The red neurons and connections represent the most important components of GPT-2 small for completing the sentence “When John and Mary went to the store, John gave a bottle to _” (known as the Indirect Object Identification (IOI) task). From (<a href=https://arxiv.org/abs/2304.14997>Conmy et al., 2023</a>).</figcaption> </figure> <p>Activation patching was used to find circuits for various tasks (<a href="https://openreview.net/forum?id=NpsVSN6o4ul">Wang et al., 2023</a>) in LLMs, including:</p> <p><strong>Example Prompt:</strong><strong> </strong>“When John and Mary went to the store, John gave a bottle to”</p> <p><strong>Completion: </strong>“Mary”</p> <p><strong>Task: </strong>Indirect Object Identification (IOI) (<a href="https://openreview.net/forum?id=NpsVSN6o4ul">Wang et al., 2023</a>)</p> <p><strong>Example Prompt: </strong>“The war lasted from 1517 to 15”</p> <p><strong>Completion: </strong>any two digit number greater than 17</p> <p><strong>Task: </strong>Greater-Than (<a href=https://arxiv.org/abs/2305.00586>Hanna et al., 2023</a>)</p> <figure> <a class=glightbox href=../Images/flm_Image_24.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt="Enter image alt description" loading=lazy src=../Images/flm_Image_24.png></a> <br> <figcaption><b>Figure 9.24:</b> Example Prompt: “The war lasted from 1517 to 15” Completion: “ files” Task: Docstring (<a href=https://www.alignmentforum.org/posts/u6KXXmKFbXfWzoAXn/a-circuit-for-python-docstrings-in-a-4-layer-attention-only>Heimersheim &amp; Janiak, 2023</a>). The model predicts the next token, which should be a copy of the next argument in the definition.</figcaption> </figure> <p>There exists numerous <abbr title="A technique that identifies which parts of a neural network are responsible for specific behaviors by selectively replacing activations.">activation patching</abbr> settings, as detailed in (<a href=https://arxiv.org/abs/2309.16042>Zhang &amp; Nanda, 2023</a>). Activation patching can be applied at different levels of granularity, ranging from patching the entire residual stream at a particular layer to patching specific token positions within the model.</p> <h3 id=01>9.3.1.1 Limitations<a class=headerlink href=#01 title="Permanent link">&para;</a></h3> <div class="admonition warning"> <p class=admonition-title>Below is extra detail provided for those interested. It can be safely skipped.</p> </div> <p><strong>A</strong><strong>ctivation patching doesn’t </strong><strong>explain the model in a fully causal way</strong>: it helps identify which components are involved in certain behaviors, but it doesn’t always clarify how those components interact or contribute causally to the overall behavior. Knowing that a particular neuron or attention head is involved doesn’t necessarily mean we understand its specific role in the model’s decision-making process. The method is context-dependent, meaning components critical for one task may not generalize to others. Also, there is a trade-off in granularity: finer patches capture more detail but may miss broader interactions, while coarser patches risk overlooking important elements. Moreover, as models grow in size, both the complexity and computational cost of using <abbr title="A technique that identifies which parts of a neural network are responsible for specific behaviors by selectively replacing activations.">activation patching</abbr> increase, making it harder to isolate meaningful circuits.</p> <h2 id=02>9.3.2 Activation Steering<a class=headerlink href=#02 title="Permanent link">&para;</a></h2> <p><strong>Activation steering is a technique used to control a model’s behavior by modifying its <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> during inference</strong>. Unlike traditional methods like fine-tuning, or <abbr title="Reinforcement Learning from Human Feedback. A method for training AI using human feedback as training signals.">RLHF</abbr>, <abbr title="A technique to control model behavior by modifying internal activations during inference, directing the model toward desired outcomes without retraining.">activation steering</abbr> allows for direct intervention without the need to retrain the model.</p> <p>Here is an example where <abbr title="A technique to control model behavior by modifying internal activations during inference, directing the model toward desired outcomes without retraining.">activation steering</abbr> was used to enforce GPT-2 into talking about love-related topics, regardless of the previous context (<a href=https://arxiv.org/abs/2308.10248>Turner et al., 2023</a>):</p> <ul> <li><strong>GPT-2 default completion:</strong></li> </ul> <p>I hate you because… -&gt; you are the most disgusting thing I have ever seen.</p> <ul> <li><strong>GPT-2 steered in the “love” direction:</strong></li> </ul> <p>I hate you because… -&gt; you are so beautiful and I want to be with you forever.</p> <p>Activation steering can be used to address remaining issues after safety training and fine-tuning by:</p> <ul> <li> <p><strong>Steering models towards desirable outcomes: </strong>Improving truthfulness (<a href=https://arxiv.org/abs/2306.03341>Li et al., 2023</a>), honesty (<a href=https://arxiv.org/abs/2310.01405>Zou et al., 2023</a>), avoiding generating toxic or harmful content, customizing<strong> </strong>chatbot personalities (e.g., making them more formal or friendly), or steering in the style of specific authors without retraining the model.</p> </li> <li> <p><strong>Post-deployment control</strong>: Monitoring AI systems for dangerous behaviors and enhancing robustness to jailbreaks by steering models to refuse harmful requests (<a href=https://arxiv.org/abs/2310.01405>Zou et al., 2023</a>). It may also be possible to strengthen other safety techniques, like <abbr title="Reinforcement Learning from Constitutional AI. A method for training AI using AI feedback based upon a constituion as training signals.">Constitutional AI</abbr>, by examining how they encourage the model toward safer and more honest behavior, as well as by identifying any gaps in this process (<a href=https://www.anthropic.com/news/mapping-mind-language-model>Anthropic, 2024</a>).</p> </li> </ul> <p>Below is a second example of steering on Claude 3 Sonnet using sparse autoencoder features:</p> <figure class=video-figure> <iframe allowfullscreen=allowfullscreen frameborder=0 src=https://www.youtube.com/embed/CJIbCV92d88 style="width: 100%; aspect-ratio: 16 / 9;"></iframe> <br> <figcaption><b>Video 9.3:</b> Dictionary learning on Claude 3 Sonnet</figcaption> </figure> <p>Note that the Representation Engineering agenda (<a href=https://arxiv.org/abs/2310.01405>Zou et al., 2023</a>) is a variant of <abbr title="A technique to control model behavior by modifying internal activations during inference, directing the model toward desired outcomes without retraining.">activation steering</abbr> that proposes to steer LLMs toward desirable outcomes such as more honesty, less bias, etc.</p> <div class="admonition warning"> <p class=admonition-title>Below is extra detail provided for those interested. It can be safely skipped.</p> </div> <p>Activation steering involves two main steps. Let’s say we want to make our model more honest, this involves two main steps:</p> <ol> <li><strong>Identify the </strong><strong><em>honesty</em></strong><strong> </strong><strong><em>direction</em></strong><strong> in the model's activation space.</strong> This is typically done by collecting model <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> for prompts designed to elicit contrasting behaviors (e.g., "honest" vs. "dishonest" responses) and analyzing these to find a linear direction that separates the two. The model's <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> can be thought of as <em>vectors</em> in a high-dimensional space. Certain <em>directions</em> in this space correspond to specific behaviors. For example, one direction might correlate with generating more positive text, while another could steer the model to talk about science. This direction, sometimes called a <em>concept vector</em>, represents the targeted attribute in activation space.</li> </ol> <figure> <a class=glightbox href=../Images/gB0_Image_25.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt="Enter image alt description" loading=lazy src=../Images/gB0_Image_25.png></a> <br> <figcaption><b>Figure 9.25:</b> Identifying an <abbr title="A technique to control model behavior by modifying internal activations during inference, directing the model toward desired outcomes without retraining.">activation steering</abbr> direction. From (<a href=https://www.alignmentforum.org/posts/3ghj8EuKzwD3MQR5G/an-introduction-to-representation-engineering-an-activation>Wehner, 2024</a>).</figcaption> </figure> <ol> <li><strong>The second step is </strong><strong><em>steering</em></strong><strong> the model’s behavior by adding this concept vector to the model's <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> at inference time</strong>. By introducing this vector at a relevant layer, we can amplify or suppress certain behaviors without retraining the model. For instance, adding the "honesty" vector to a model’s <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> during inference nudges it toward generating more honest responses.</li> </ol> <figure> <a class=glightbox href=../Images/Bi0_Image_26.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt="Enter image alt description" loading=lazy src=../Images/Bi0_Image_26.png></a> <br> <figcaption><b>Figure 9.26:</b> The concept vector is added to the <abbr title="The outputs produced by neurons or units in a neural network after processing input data through a layer.">activations</abbr> at a specific layer to influence the model’s behavior in the desired direction. From (<a href=https://www.alignmentforum.org/posts/3ghj8EuKzwD3MQR5G/an-introduction-to-representation-engineering-an-activation>Wehner, 2024</a>).</figcaption> </figure> <p>The <em>concept vector</em> can also be obtained using a <strong>linear probe</strong> (see section on Probing Classifiers), or can be a feature found through <strong>dictionary learning</strong> (see section on Sparse Autoencoders) as shown on the Claude 3 Sonnet video above.</p> <div class=section-end> <span>❧</span> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=footer.title> <a href=../02/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction>Previous</span> 9.2 Observational Methods </div> </div> </a> <a href=../04/ class="md-footer__link md-footer__link--next" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction>Next</span> 9.4 Automating and Scaling Interpretability </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=footer-social-container> <hr class=footer-line> <div class=footer-social> <a href=https://github.com/CentreSecuriteIA class="footer-social__link github" title=GitHub> <i class="fab fa-github"></i> </a> <a href=https://youtube.com/@securite-ia class="footer-social__link youtube" title=YouTube> <i class="fab fa-youtube"></i> </a> <a href=https://discord.gg/YtatCZ3SQ8 class="footer-social__link discord" title=Discord> <i class="fab fa-discord"></i> </a> </div> <hr class=footer-line> </div> <div class=footer-identity> <a href=https://www.securite-ia.fr/ class=footer-logo target=_blank rel=noopener> <img src=https://ai-safety-atlas.com/assets/CeSIA_transparent_white_pure.png alt="CeSIA - French Center for AI Safety"> </a> </div> <div class=footer-info> <div class=footer-links> <a href=mailto:contact@securite-ia.fr>Contact</a> <span class=separator>•</span> <a href=https://forms.gle/Z3rzFfCrLJdDv8HDA>Feedback</a> </div> <div class=footer-legal> <span>© Copyright 2025 </span> <span class=separator>•</span> <span>Text Content: <a href=https://creativecommons.org/licenses/by-sa/4.0/ >CC BY-SA 4.0</a></span> <span class=separator>•</span> <span>Code: <a href=https://opensource.org/licenses/MIT>MIT</a></span> </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.footer", "navigation.sections", "navigation.tacking", "navigation.path", "navigation.prune", "content.tooltips", "content.footnote.tooltips", "header.autohide", "announce.dismiss", "toc.follow", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.13a4f30d.min.js></script> <script src=../../../overrides/js/mathjax.js></script> <script src=../../../overrides/js/tippy.js></script> <script src=../../../overrides/js/navigation.js></script> <script src=../../../overrides/js/scroll-buttons.js></script> <script src=../../../overrides/js/home/base.js></script> <script src=../../../overrides/js/home/hero.js></script> <script src=../../../overrides/js/home/why.js></script> <script src=../../../overrides/js/home/header.js></script> <script src=../../../overrides/js/home/scroll-animations.js></script> <script src=../../../overrides/js/audio-player.js></script> <script src=https://unpkg.com/@popperjs/core@2></script> <script src=https://unpkg.com/tippy.js@6></script> <script src=https://unpkg.com/tippy.js@6/dist/animations/perspective-extreme.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../docs/assets/js/custom.js></script> <script type=application/ld+json>
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://ai-safety-atlas.com/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": {
        "@type": "EntryPoint",
        "urlTemplate": "https://ai-safety-atlas.com/?q={search_term_string}"
      },
      "query-input": "required name=search_term_string"
    }
  }
</script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>